<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Spark踩坑之Streaming在Kerberos的hadoop中renew失败 | Adam Home</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Spark踩坑之Streaming在Kerberos的hadoop中renew失败</h1><a id="logo" href="/.">Adam Home</a><p class="description">快意回首，拂心莫停</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于我</i></a><a href="/timeline/"><i class="fa fa-line-chart"> 历史</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Spark踩坑之Streaming在Kerberos的hadoop中renew失败</h1><div class="post-meta">Nov 24, 2016<span> | </span><span class="category"><a href="/categories/spark开发/">spark开发</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#问题描述："><span class="toc-number">1.</span> <span class="toc-text">问题描述：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#可能的原因"><span class="toc-number">2.</span> <span class="toc-text">可能的原因</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题的暂时解决"><span class="toc-number">3.</span> <span class="toc-text">问题的暂时解决</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题解决"><span class="toc-number">4.</span> <span class="toc-text">问题解决</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hadoop修复方案"><span class="toc-number">4.1.</span> <span class="toc-text">hadoop修复方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spark修复方案"><span class="toc-number">4.2.</span> <span class="toc-text">spark修复方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#后记"><span class="toc-number">4.3.</span> <span class="toc-text">后记</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#引用"><span class="toc-number">4.3.1.</span> <span class="toc-text">引用</span></a></li></ol></li></ol></li></ol></div></div><div class="post-content"><h2 id="问题描述："><a href="#问题描述：" class="headerlink" title="问题描述："></a>问题描述：</h2><p>SparkStreaming任务的Kerberos环境下两天后出现 AMRMTOKEN INVALID</p>
<p>早上回来，跑在yarn上面的Streaming程序莫名奇妙崩溃了，yarn logs 查看日志，700万行，发现在每个executor的最后报错如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">16/11/01 15:02:05 INFO executor.CoarseGrainedExecutorBackend: Registered signal handlers <span class="keyword">for</span> [TERM, HUP, INT]</div><div class="line">16/11/01 15:02:06 INFO spark.SecurityManager: Changing view acls to: wzfw</div><div class="line">16/11/01 15:02:06 INFO spark.SecurityManager: Changing modify acls to: wzfw</div><div class="line">16/11/01 15:02:06 INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: Set(wzfw); users with modify permissions: Set(wzfw)</div><div class="line">...</div><div class="line">16/11/02 03:51:33 ERROR executor.CoarseGrainedExecutorBackend: RECEIVED SIGNAL 15: SIGTERM</div><div class="line">...</div><div class="line">16/11/02 03:51:34 ERROR executor.CoarseGrainedExecutorBackend: RECEIVED SIGNAL 15: SIGTERM</div><div class="line">16/11/02 03:51:34 WARN executor.CoarseGrainedExecutorBackend: An unknown (NM-304-SA5212M4-BIGDATA-519:44457) driver disconnected.</div><div class="line">16/11/02 03:51:34 ERROR executor.CoarseGrainedExecutorBackend: Driver 10.142.116.19:44457 disassociated! Shutting down.</div></pre></td></tr></table></figure></p>
<p>这个报错应该只是表象，原因应该出自driver，定位到driver： NM-304-SA5212M4-BIGDATA-519<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">16/11/02 03:51:34 WARN executor.CoarseGrainedExecutorBackend: An unknown (NM-304-SA5212M4-BIGDATA-519:44457) driver disconnected.</div><div class="line">16/11/02 03:51:34 ERROR executor.CoarseGrainedExecutorBackend: Driver 10.142.116.19:44457 disassociated! Shutting down.</div><div class="line">16/11/02 03:51:34 ERROR executor.CoarseGrainedExecutorBackend: RECEIVED SIGNAL 15: SIGTERM</div><div class="line">16/11/02 03:51:34 ERROR client.TransportClient: Failed to send RPC 5285936577870185909 to NM-304-SA5212M4-BIGDATA-519/10.142.116.19:44457: java.nio.channels.ClosedChannelException</div><div class="line">java.nio.channels.ClosedChannelException</div><div class="line">16/11/02 03:51:34 WARN netty.NettyRpcEndpointRef: Error sending message [message = Heartbeat(53,[Lscala.Tuple2;@519f65d9,BlockManagerId(53, NM-304-SA5212M4-BIGDATA-382, 29163))] <span class="keyword">in</span> 1 attempts</div><div class="line">java.io.IOException: Failed to send RPC 5285936577870185909 to NM-304-SA5212M4-BIGDATA-519/10.142.116.19:44457: java.nio.channels.ClosedChannelException</div><div class="line">        at org.apache.spark.network.client.TransportClient<span class="variable">$3</span>.operationComplete(TransportClient.java:239)</div><div class="line">        at org.apache.spark.network.client.TransportClient<span class="variable">$3</span>.operationComplete(TransportClient.java:226)</div><div class="line">        at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:680)</div><div class="line">        at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:567)</div><div class="line">        at io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:424)</div><div class="line">        at io.netty.channel.AbstractChannel<span class="variable">$AbstractUnsafe</span>.safeSetFailure(AbstractChannel.java:801)</div><div class="line">        at io.netty.channel.AbstractChannel<span class="variable">$AbstractUnsafe</span>.write(AbstractChannel.java:699)</div><div class="line">        at io.netty.channel.DefaultChannelPipeline<span class="variable">$HeadContext</span>.write(DefaultChannelPipeline.java:1122)</div><div class="line">        at io.netty.channel.AbstractChannelHandlerContext.invokeWrite(AbstractChannelHandlerContext.java:633)</div><div class="line">        at io.netty.channel.AbstractChannelHandlerContext.access<span class="variable">$1900</span>(AbstractChannelHandlerContext.java:32)</div><div class="line">        at io.netty.channel.AbstractChannelHandlerContext<span class="variable">$AbstractWriteTask</span>.write(AbstractChannelHandlerContext.java:908)</div><div class="line">        at io.netty.channel.AbstractChannelHandlerContext<span class="variable">$WriteAndFlushTask</span>.write(AbstractChannelHandlerContext.java:960)</div><div class="line">        at io.netty.channel.AbstractChannelHandlerContext<span class="variable">$AbstractWriteTask</span>.run(AbstractChannelHandlerContext.java:893)</div><div class="line">        at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:357)</div><div class="line">        at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:357)</div><div class="line">        at io.netty.util.concurrent.SingleThreadEventExecutor<span class="variable">$2</span>.run(SingleThreadEventExecutor.java:111)</div><div class="line">        at java.lang.Thread.run(Thread.java:745)</div><div class="line">Caused by: java.nio.channels.ClosedChannelException</div></pre></td></tr></table></figure></p>
<p>找到driver的日志：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Container: container_1477044851292_468337_02_000004 on NM-304-SA5212M4-BIGDATA-519_8041</div><div class="line">=========================================================================================</div><div class="line">LogType:stderr</div><div class="line">Log Upload Time:星期三 十一月 02 03:51:47 +0800 2016</div><div class="line">LogLength:194115722</div><div class="line">Log Contents:</div></pre></td></tr></table></figure></p>
<p>根据时间定位：（vim中在driver中搜索 16\/11\/02 03:51:3）</p>
<p>发现问题出题的源头：<br>在 16/11/02 03:40 之前，driver的日志还是比较稳定的，但是在 此之后，频繁出现下述异常：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line">16/11/01 15:11:43 INFO ApplicationMaster: Registered signal handlers <span class="keyword">for</span> [TERM, HUP, INT]</div><div class="line">16/11/01 15:11:43 INFO ApplicationMaster: ApplicationAttemptId: appattempt_1477044851292_468337_000002</div><div class="line">16/11/01 15:11:45 INFO SecurityManager: Changing view acls to: wzfw</div><div class="line">16/11/01 15:11:45 INFO SecurityManager: Changing modify acls to: wzfw</div><div class="line">16/11/01 15:11:45 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: Set(wzfw); users with modify permissions: Set(wzfw)</div><div class="line">...</div><div class="line">16/11/02 03:41:17 WARN Client: Exception encountered <span class="keyword">while</span> connecting to the server : org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.token.SecretManager<span class="variable">$InvalidToken</span>): Invalid AMRMToken from appattempt_1477044851292_468337_000002</div><div class="line">16/11/02 03:41:17 INFO RetryInvocationHandler: Exception <span class="keyword">while</span> invoking allocate of class ApplicationMasterProtocolPBClientImpl over rm1. Trying to fail over immediately.</div><div class="line">org.apache.hadoop.security.token.SecretManager<span class="variable">$InvalidToken</span>: Invalid AMRMToken from appattempt_1477044851292_468337_000002</div><div class="line">        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)</div><div class="line">        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)</div><div class="line">        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)</div><div class="line">        at java.lang.reflect.Constructor.newInstance(Constructor.java:526)</div><div class="line">        at org.apache.hadoop.yarn.ipc.RPCUtil.instantiateException(RPCUtil.java:53)</div><div class="line">        at org.apache.hadoop.yarn.ipc.RPCUtil.unwrapAndThrowException(RPCUtil.java:104)</div><div class="line">        at org.apache.hadoop.yarn.api.impl.pb.client.ApplicationMasterProtocolPBClientImpl.allocate(ApplicationMasterProtocolPBClientImpl.java:79)</div><div class="line">        at sun.reflect.GeneratedMethodAccessor137.invoke(Unknown Source)</div><div class="line">        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</div><div class="line">        at java.lang.reflect.Method.invoke(Method.java:606)</div><div class="line">        at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:187)</div><div class="line">        at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)</div><div class="line">        at com.sun.proxy.<span class="variable">$Proxy19</span>.allocate(Unknown Source)</div><div class="line">        at org.apache.hadoop.yarn.client.api.impl.AMRMClientImpl.allocate(AMRMClientImpl.java:278)</div><div class="line">        at org.apache.spark.deploy.yarn.YarnAllocator.allocateResources(YarnAllocator.scala:225)</div><div class="line">        at org.apache.spark.deploy.yarn.ApplicationMaster$<span class="variable">$anon</span><span class="variable">$1</span>.run(ApplicationMaster.scala:384)</div><div class="line">Caused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.token.SecretManager<span class="variable">$InvalidToken</span>): Invalid AMRMToken from appattempt_1477044851292_468337_000002</div><div class="line">        at org.apache.hadoop.ipc.Client.call(Client.java:1468)</div><div class="line">        at org.apache.hadoop.ipc.Client.call(Client.java:1399)</div><div class="line">        at org.apache.hadoop.ipc.ProtobufRpcEngine<span class="variable">$Invoker</span>.invoke(ProtobufRpcEngine.java:232)</div><div class="line">        at com.sun.proxy.<span class="variable">$Proxy18</span>.allocate(Unknown Source)</div><div class="line">        at org.apache.hadoop.yarn.api.impl.pb.client.ApplicationMasterProtocolPBClientImpl.allocate(ApplicationMasterProtocolPBClientImpl.java:77)</div><div class="line">        ... 9 more</div><div class="line">16/11/02 03:41:17 INFO ConfiguredRMFailoverProxyProvider: Failing over to rm2</div><div class="line">16/11/02 03:41:17 INFO RetryInvocationHandler: Exception <span class="keyword">while</span> invoking allocate of class ApplicationMasterProtocolPBClientImpl over rm2 after 1 fail over attempts. Trying to fail over after sleeping <span class="keyword">for</span> 22672ms.</div><div class="line">java.net.ConnectException: Call From NM-304-SA5212M4-BIGDATA-519/10.142.116.19 to NM-304-RH5885V3-BIGDATA-008:8030 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused</div><div class="line">        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)</div><div class="line">        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)</div><div class="line">        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)</div><div class="line">        at java.lang.reflect.Constructor.newInstance(Constructor.java:526)</div><div class="line">        at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:791)</div><div class="line">        at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:731)</div><div class="line">        at org.apache.hadoop.ipc.Client.call(Client.java:1472)</div><div class="line">        at org.apache.hadoop.ipc.Client.call(Client.java:1399)</div><div class="line">        at org.apache.hadoop.ipc.ProtobufRpcEngine<span class="variable">$Invoker</span>.invoke(ProtobufRpcEngine.java:232)</div><div class="line">        at com.sun.proxy.<span class="variable">$Proxy18</span>.allocate(Unknown Source)</div><div class="line">        at org.apache.hadoop.yarn.api.impl.pb.client.ApplicationMasterProtocolPBClientImpl.allocate(ApplicationMasterProtocolPBClientImpl.java:77)</div><div class="line">        at sun.reflect.GeneratedMethodAccessor137.invoke(Unknown Source)</div><div class="line">        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</div><div class="line">        at java.lang.reflect.Method.invoke(Method.java:606)</div><div class="line">        at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:187)</div><div class="line">        at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)</div><div class="line">        at com.sun.proxy.<span class="variable">$Proxy19</span>.allocate(Unknown Source)</div><div class="line">        at org.apache.hadoop.yarn.client.api.impl.AMRMClientImpl.allocate(AMRMClientImpl.java:278)</div><div class="line">        at org.apache.spark.deploy.yarn.YarnAllocator.allocateResources(YarnAllocator.scala:225)</div><div class="line">        at org.apache.spark.deploy.yarn.ApplicationMaster$<span class="variable">$anon</span><span class="variable">$1</span>.run(ApplicationMaster.scala:384)</div><div class="line">Caused by: java.net.ConnectException: Connection refused</div><div class="line">        at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)</div><div class="line">        at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:739)</div><div class="line">        at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)</div><div class="line">        at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:530)</div><div class="line">        at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:494)</div><div class="line">        at org.apache.hadoop.ipc.Client<span class="variable">$Connection</span>.setupConnection(Client.java:607)</div><div class="line">        at org.apache.hadoop.ipc.Client<span class="variable">$Connection</span>.setupIOstreams(Client.java:705)</div><div class="line">        at org.apache.hadoop.ipc.Client<span class="variable">$Connection</span>.access<span class="variable">$2800</span>(Client.java:368)</div><div class="line">        at org.apache.hadoop.ipc.Client.getConnection(Client.java:1521)</div><div class="line">        at org.apache.hadoop.ipc.Client.call(Client.java:1438)</div><div class="line">        ... 13 more</div><div class="line">16/11/02 03:41:20 INFO JobScheduler: Added <span class="built_in">jobs</span> <span class="keyword">for</span> time 1478029280000 ms</div></pre></td></tr></table></figure>
<p>然后这些日志持续出现了十分钟左右，当然spark的stage是依旧在增加，依旧在运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">16/11/02 03:51:27 INFO RetryInvocationHandler: Exception <span class="keyword">while</span> invoking allocate of class ApplicationMasterProtocolPBClientImpl over rm1 after 14 fail over attempts. Trying to fail over immediately.</div><div class="line">org.apache.hadoop.security.token.SecretManager<span class="variable">$InvalidToken</span>: Invalid AMRMToken from appattempt_1477044851292_468337_000002</div><div class="line">        at sun.reflect.GeneratedConstructorAccessor74.newInstance(Unknown Source)</div><div class="line">        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)</div><div class="line">        at java.lang.reflect.Constructor.newInstance(Constructor.java:526)</div><div class="line">        at org.apache.hadoop.yarn.ipc.RPCUtil.instantiateException(RPCUtil.java:53)</div><div class="line">        at org.apache.hadoop.yarn.ipc.RPCUtil.unwrapAndThrowException(RPCUtil.java:104)</div><div class="line">        at org.apache.hadoop.yarn.api.impl.pb.client.ApplicationMasterProtocolPBClientImpl.allocate(ApplicationMasterProtocolPBClientImpl.java:79)</div><div class="line">        at sun.reflect.GeneratedMethodAccessor137.invoke(Unknown Source)</div><div class="line">        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</div><div class="line">        at java.lang.reflect.Method.invoke(Method.java:606)</div><div class="line">        at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:187)</div><div class="line">        at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)</div><div class="line">        at com.sun.proxy.<span class="variable">$Proxy19</span>.allocate(Unknown Source)</div><div class="line">        at org.apache.hadoop.yarn.client.api.impl.AMRMClientImpl.allocate(AMRMClientImpl.java:278)</div><div class="line">        at org.apache.spark.deploy.yarn.YarnAllocator.allocateResources(YarnAllocator.scala:225)</div><div class="line">        at org.apache.spark.deploy.yarn.ApplicationMaster$<span class="variable">$anon</span><span class="variable">$1</span>.run(ApplicationMaster.scala:384)</div><div class="line">Caused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.token.SecretManager<span class="variable">$InvalidToken</span>): Invalid AMRMToken from appattempt_1477044851292_468337_000002</div><div class="line">        at org.apache.hadoop.ipc.Client.call(Client.java:1468)</div><div class="line">        at org.apache.hadoop.ipc.Client.call(Client.java:1399)</div><div class="line">        at org.apache.hadoop.ipc.ProtobufRpcEngine<span class="variable">$Invoker</span>.invoke(ProtobufRpcEngine.java:232)</div><div class="line">        at com.sun.proxy.<span class="variable">$Proxy18</span>.allocate(Unknown Source)</div><div class="line">        at org.apache.hadoop.yarn.api.impl.pb.client.ApplicationMasterProtocolPBClientImpl.allocate(ApplicationMasterProtocolPBClientImpl.java:77)</div><div class="line">        ... 9 more</div><div class="line">16/11/02 03:51:27 INFO ConfiguredRMFailoverProxyProvider: Failing over to rm2</div><div class="line">16/11/02 03:51:27 INFO RetryInvocationHandler: Exception <span class="keyword">while</span> invoking allocate of class ApplicationMasterProtocolPBClientImpl over rm2 after 15 fail over attempts. Trying to fail over after sleeping <span class="keyword">for</span> 31772ms.</div><div class="line">java.net.ConnectException: Call From NM-304-SA5212M4-BIGDATA-519/10.142.116.19 to NM-304-RH5885V3-BIGDATA-008:8030 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused</div><div class="line">        at sun.reflect.GeneratedConstructorAccessor75.newInstance(Unknown Source)</div><div class="line">        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)</div><div class="line">        at java.lang.reflect.Constructor.newInstance(Constructor.java:526)</div><div class="line">        at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:791)</div><div class="line">        at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:731)</div><div class="line">        at org.apache.hadoop.ipc.Client.call(Client.java:1472)</div><div class="line">        at org.apache.hadoop.ipc.Client.call(Client.java:1399)</div><div class="line">        at org.apache.hadoop.ipc.ProtobufRpcEngine<span class="variable">$Invoker</span>.invoke(ProtobufRpcEngine.java:232)</div><div class="line">        at com.sun.proxy.<span class="variable">$Proxy18</span>.allocate(Unknown Source)</div><div class="line">        at org.apache.hadoop.yarn.api.impl.pb.client.ApplicationMasterProtocolPBClientImpl.allocate(ApplicationMasterProtocolPBClientImpl.java:77)</div><div class="line">        at sun.reflect.GeneratedMethodAccessor137.invoke(Unknown Source)</div><div class="line">        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</div><div class="line">        at java.lang.reflect.Method.invoke(Method.java:606)</div><div class="line">        at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:187)</div><div class="line">        at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)</div><div class="line">        at com.sun.proxy.<span class="variable">$Proxy19</span>.allocate(Unknown Source)</div><div class="line">        at org.apache.hadoop.yarn.client.api.impl.AMRMClientImpl.allocate(AMRMClientImpl.java:278)</div><div class="line">        at org.apache.spark.deploy.yarn.YarnAllocator.allocateResources(YarnAllocator.scala:225)</div><div class="line">        at org.apache.spark.deploy.yarn.ApplicationMaster$<span class="variable">$anon</span><span class="variable">$1</span>.run(ApplicationMaster.scala:384)</div><div class="line">Caused by: java.net.ConnectException: Connection refused</div><div class="line">        at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)</div><div class="line">        at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:739)</div><div class="line">        at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)</div><div class="line">        at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:530)</div><div class="line">        at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:494)</div><div class="line">        at org.apache.hadoop.ipc.Client<span class="variable">$Connection</span>.setupConnection(Client.java:607)</div><div class="line">        at org.apache.hadoop.ipc.Client<span class="variable">$Connection</span>.setupIOstreams(Client.java:705)</div><div class="line">        at org.apache.hadoop.ipc.Client<span class="variable">$Connection</span>.access<span class="variable">$2800</span>(Client.java:368)</div><div class="line">        at org.apache.hadoop.ipc.Client.getConnection(Client.java:1521)</div><div class="line">        at org.apache.hadoop.ipc.Client.call(Client.java:1438)</div><div class="line">        ... 13 more</div></pre></td></tr></table></figure>
<p>然后在最后收到这个信号就挂了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">16/11/02 03:51:31 INFO WriteAheadLogManager  <span class="keyword">for</span> Thread: Attempting to clear 0 old <span class="built_in">log</span> files <span class="keyword">in</span> hdfs://ns/user/wzfw/checkpoint/receivedBlockMetadata older than 1478029880000:</div><div class="line">16/11/02 03:51:31 INFO InputInfoTracker: remove old batch metadata: 1478029870000 ms</div><div class="line">16/11/02 03:51:32 INFO ApplicationMaster: Final app status: FAILED, <span class="built_in">exit</span>Code: 16</div><div class="line">16/11/02 03:51:32 WARN ApplicationMaster: Reporter thread fails 2 time(s) <span class="keyword">in</span> a row.</div><div class="line">java.lang.reflect.UndeclaredThrowableException</div><div class="line">        at com.sun.proxy.<span class="variable">$Proxy19</span>.allocate(Unknown Source)</div><div class="line">        at org.apache.hadoop.yarn.client.api.impl.AMRMClientImpl.allocate(AMRMClientImpl.java:278)</div><div class="line">        at org.apache.spark.deploy.yarn.YarnAllocator.allocateResources(YarnAllocator.scala:225)</div><div class="line">        at org.apache.spark.deploy.yarn.ApplicationMaster$<span class="variable">$anon</span><span class="variable">$1</span>.run(ApplicationMaster.scala:384)</div><div class="line">Caused by: java.lang.InterruptedException: sleep interrupted</div><div class="line">        at java.lang.Thread.sleep(Native Method)</div><div class="line">        at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:151)</div><div class="line">        ... 4 more</div><div class="line">16/11/02 03:51:32 ERROR ApplicationMaster: RECEIVED SIGNAL 15: SIGTERM</div><div class="line">16/11/02 03:51:33 INFO StreamingContext: Invoking stop(stopGracefully=<span class="literal">false</span>) from shutdown hook</div><div class="line">16/11/02 03:51:33 INFO JobGenerator: Stopping JobGenerator immediately</div></pre></td></tr></table></figure>
<p>后来又跑了一次，又因为同样的原因挂了，这次统计了时间：<br>slaver：<br>程序启动时间：16/11/02 22:58:27<br>程序结束时间： 16/11/03 22:51:34</p>
<p>driver<br>程序启动时间：16/11/02 22:58:18<br>遇到Kerberos问题时间： 16/11/03 22:41:23<br>程序结束时间：16/11/03 22:51:35</p>
<p>上面的时间是有不正确的地方的，因为我启动的时间肯定不是16/11/02 22:58:18（那个时候我已经回家了），我是在 11/02号当天上午启动，所以一个很可能的原因是，在22:58的这个时候，因为种种原因，程序崩溃重启，换了一个driver。</p>
<h2 id="可能的原因"><a href="#可能的原因" class="headerlink" title="可能的原因"></a>可能的原因</h2><p>google一下，网上查到有类似的原因：<br>storm on yarn在这个问题中存在一些bug；<br><a href="https://community.cloudera.com/t5/Batch-Processing-and-Workflow/Long-running-yarn-app-storm-yarn-exits-with-Invalid-AMRMToken/td-p/26717" target="_blank" rel="external">https://community.cloudera.com/t5/Batch-Processing-and-Workflow/Long-running-yarn-app-storm-yarn-exits-with-Invalid-AMRMToken/td-p/26717</a></p>
<p><a href="http://www.codeflitting.com/blog/article/%E4%B8%BA%E9%95%BF%E6%97%B6%E9%97%B4%E8%BF%90%E8%A1%8C%E7%9A%84%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E9%85%8D%E7%BD%AE%20YARN" target="_blank" rel="external">http://www.codeflitting.com/blog/article/%E4%B8%BA%E9%95%BF%E6%97%B6%E9%97%B4%E8%BF%90%E8%A1%8C%E7%9A%84%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E9%85%8D%E7%BD%AE%20YARN</a></p>
<p><a href="https://issues.apache.org/jira/browse/YARN-3103" target="_blank" rel="external">https://issues.apache.org/jira/browse/YARN-3103</a></p>
<p>根据日志以及网上资料，初步认为与Kerberos过期认证有关，AMRMToken无效，也就是说，在运行了一段时期（一天多）后，AM到RM的token无效了，然后无效很多次后，后续的任务分配不到container，所以程序就挂了，突然想到，出现这种错误的原因有以下几种；</p>
<ol>
<li><p>大约12个小时以前，SparkStreaming程序因为后面的flume测试守护进程，导致换了一个driver，是否是由于driver改动后，导致token失效？</p>
</li>
<li><p>yarn 2.6.0有一个相关的bug，<a href="https://issues.apache.org/jira/browse/YARN-3103" target="_blank" rel="external">https://issues.apache.org/jira/browse/YARN-3103</a><br>AMRMClientImpl.updateAMRMToken updates the token service before storing it to the credentials, so the token is mapped using the newly updated service rather than the empty service that was used when the RM created the original AMRM token. This leads to two AMRM tokens in the credentials and can still fail if the AMRMTokenSelector picks the wrong one.<br>In addition the AMRMClientImpl grabs the login user rather than the current user when security is enabled, so it’s likely the UGI being updated is not the UGI that will be used when reconnecting to the RM.<br>The end result is that AMs can fail with invalid token errors when trying to reconnect to an RM after a new AMRM secret has been activated.<br>大概意思是，更新token的时候会有两个token，如果选择了错误的token，就会导致出错</p>
</li>
<li><p>hadoop设置仅允许 hdfs 用户的委派令牌保留最大生存期 7 （default）天，这始终是不够的<br>需要修改一下yarn的配置，增加如下参数：</p>
</li>
</ol>
<p>将 ResourceManager 配置为对应 HDFS NameNode 的代理用户，以便在现有令牌超过其最大生存期时，ResourceManager 可以请求新的令牌。YARN 随后能够代表 hdfs 用户继续执行本地化和日志聚合</p>
<figure class="highlight xml"><figcaption><span>yarn-site.xml</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.proxy-user-privileges.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">``` xml core-site.xml</div><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.yarn.hosts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.yarn.groups<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div></pre></td></tr></table></figure>
<p>然后重启YARN和HDFS服务</p>
<h2 id="问题的暂时解决"><a href="#问题的暂时解决" class="headerlink" title="问题的暂时解决"></a>问题的暂时解决</h2><p>由于项目紧张，我写了一个脚本，每隔一分钟监控yarn上面运行的spark Streaming程序，如果挂了就重新启动起来，虽然也不影响后续的结果。后来观察，基本上是一天一挂或者两天一挂，不过这也太不靠谱了。</p>
<h2 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h2><p>后来发现都不是上述原因，同事的前爱奇艺的同事遇到过同样的问题：原因是：<br><strong> NameNode采用了HA后，AM与Namenode通信使用的token的结构变为HA token,HA token中会有两个private token，代表两台namenode服务。 当AM更新token时，会调用hadoop客户端的addDelegationTokens更新token。但addDelegationTokens存在问题，其只会更新HA token，不会更新private token，而AM向NameNode发起请求时，会使用private token，导致出现异常。</strong></p>
<p>发生这个问题需要以下几个条件：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">1. NameNode HA is enabled.</div><div class="line">2. Kerberos is enabled.</div><div class="line">3. HDFS Delegation Token (not Keytab or TGT) is used to communicate with NameNode.</div><div class="line">4. We want to update the HDFS Delegation Token <span class="keyword">for</span> long running applicatons. HDFS Client will generate private tokens <span class="keyword">for</span> each NameNode. When we update the HDFS Delegation Token, these private tokens will not be updated, <span class="built_in">which</span> will cause token expired.</div></pre></td></tr></table></figure></p>
<h3 id="hadoop修复方案"><a href="#hadoop修复方案" class="headerlink" title="hadoop修复方案"></a>hadoop修复方案</h3><p>这是hadoop的一个bug，在hadoop 2.9的新版本中修复了这个问题，所以，给hadoop打个patch就好了：</p>
<p>Hadoop: <a href="https://issues.apache.org/jira/browse/HDFS-9276" target="_blank" rel="external">https://issues.apache.org/jira/browse/HDFS-9276</a><br>hadoop2.9修复了private token不更新问题</p>
<h3 id="spark修复方案"><a href="#spark修复方案" class="headerlink" title="spark修复方案"></a>spark修复方案</h3><p>Spark： <a href="https://github.com/apache/spark/pull/9168/files" target="_blank" rel="external">https://github.com/apache/spark/pull/9168/files</a><br>主动使FileSystem对象关闭，再重新建立。FileSystem对象建立期间会重新设置private token</p>
<p>由于hadoop变动对生产环境的影响很大，所以我们选择了spark的修复方案，修改了源码后打包编译上线，问题解决；</p>
<p>感谢聪哥，也感谢那位在爱奇艺的发现并解决了这个问题的大神，没有你们，我要惨了。</p>
<p>与Kerberos对干的日子很酸爽</p>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>还有一个方案可以解决这个问题，可以不需要修改spark源码，提交的时候增加参数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">--conf spark.hadoop.fs.hdfs.impl.disable.cache=true</div></pre></td></tr></table></figure></p>
<h4 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h4><p><a href="http://mkuthan.github.io/blog/2016/09/30/spark-streaming-on-yarn/" target="_blank" rel="external">http://mkuthan.github.io/blog/2016/09/30/spark-streaming-on-yarn/</a></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://flume.cn/2016/11/24/Spark踩坑之Streaming在Kerberos的hadoop中renew失败/" data-id="cjgd2byei001iegguy65i7chw" class="article-share-link">分享</a><div class="tags"><a href="/tags/kerberos/">kerberos</a><a href="/tags/spark-streaming/">spark streaming</a><a href="/tags/spark开发/">spark开发</a></div><div class="post-nav"><a href="/2016/11/24/通过经纬度计算距离算法的scala实现/" class="pre">通过经纬度计算距离算法的scala实现</a><a href="/2016/11/24/Spark踩坑之Streaming程序实时读写哨兵模式的Redis/" class="next">Spark踩坑之Streaming程序实时读写哨兵模式的Redis</a></div><div id="uyan_frame"></div><script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2139407"></script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/eagle/">eagle</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/flume/">flume</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/scala/">scala</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/spark/">spark</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/spark开发/">spark开发</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/spring-cloud/">spring cloud</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/单车岁月/">单车岁月</a><span class="category-list-count">5</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/大数据开发/" style="font-size: 15px;">大数据开发</a> <a href="/tags/scala/" style="font-size: 15px;">scala</a> <a href="/tags/hue/" style="font-size: 15px;">hue</a> <a href="/tags/kerberos/" style="font-size: 15px;">kerberos</a> <a href="/tags/livy/" style="font-size: 15px;">livy</a> <a href="/tags/hbase/" style="font-size: 15px;">hbase</a> <a href="/tags/yarn/" style="font-size: 15px;">yarn</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/flume/" style="font-size: 15px;">flume</a> <a href="/tags/spark-streaming/" style="font-size: 15px;">spark streaming</a> <a href="/tags/kafka/" style="font-size: 15px;">kafka</a> <a href="/tags/spark/" style="font-size: 15px;">spark</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/持续更新/" style="font-size: 15px;">持续更新</a> <a href="/tags/spark开发/" style="font-size: 15px;">spark开发</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a> <a href="/tags/散文/" style="font-size: 15px;">散文</a> <a href="/tags/eagle/" style="font-size: 15px;">eagle</a> <a href="/tags/架构/" style="font-size: 15px;">架构</a> <a href="/tags/spring-cloud/" style="font-size: 15px;">spring cloud</a> <a href="/tags/微服务/" style="font-size: 15px;">微服务</a> <a href="/tags/es/" style="font-size: 15px;">es</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/01/08/spark2-2新版本编译打包/">spark2.2新版本编译打包</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/31/使用Ansable安装管理Spark客户端/">使用Ansable安装管理Spark客户端</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/17/spark往ES中写入数据的方法/">spark往ES中写入数据的方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/17/spark指定java版本向yarn提交程序/">spark在yarn中运行jdk8</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/29/返回区域实时人数的思路与总结/">返回区域实时人数的思路与总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/28/位置服务开发上线总结/">位置服务开发上线总结————实时数据推送</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/22/spark奇技淫巧总结之flatMap/">spark奇技淫巧总结之强大的flatMap</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/22/OpenAPI微服务接入规范/">OpenAPI微服务接入规范</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/29/OpenApi之我浅薄见解/">OpenApi之我浅薄见解</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/24/阿里巴巴Java开发手册学习笔记2/">阿里巴巴Java开发手册学习笔记（下）</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://issues.apache.org/jira/secure/Dashboard.jspa" title="有问题上JIRA" target="_blank">有问题上JIRA</a><ul></ul><a href="https://github.com/lw-lin/CoolplaySpark" title="酷玩 Spark" target="_blank">酷玩 Spark</a><ul></ul><a href="http://lqding.blog.51cto.com" title="叮咚的51博客" target="_blank">叮咚的51博客</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">Adam Home.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>